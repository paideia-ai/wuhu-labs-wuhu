#!/bin/bash
set -e

# Capture staged files before formatting
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACMR)

if [ -d core ]; then
  deno fmt core
fi
if [ -d web ]; then
  deno fmt web
fi

# Re-stage only what was previously staged
if [ -n "$STAGED_FILES" ]; then
  git add $STAGED_FILES
fi
